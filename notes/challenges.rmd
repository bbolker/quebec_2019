---
title: "Fitting challenges"
author: Ben Bolker
date: "`r format(Sys.time(), '%H:%M %d %B %Y ')`"
bibliography: ../nonlin.bib
---

![cc](pix/cc-attrib-nc.png)
Licensed under the 
[Creative Commons attribution-noncommercial license](http://creativecommons.org/licenses/by-nc/3.0/).
Please share \& remix noncommercially, mentioning its origin.

## errors/problems

- bad initial conditions 
     - predictions outside of feasible range (counts <0, prob outside of (0,1))
	 - underflow/overflow
	 - convergence to extreme/flat ranges

**example**?

## lots of parameters (high dimensionality)

- not really an intrinsic problem
- hard to visualize
- slow


## visualization

- slices
- `expand.grid()` plus ggplot (`geom_tile()` + `facet_grid()` works up to 4D: maybe `ggforce::facet_grid_paginate()` if you're crazy)

## slowness

- @ross_faster_2013 [link](http://www.noamross.net/blog/2013/4/25/faster-talk.html):
      - rewrite in C++
      - parallelize (hard in this case)


## discontinuities and thresholds

- Nelder-Mead
- profiling

## multi-modality

- can be very hard to tell (Simon Wood examples)
- check convergence
- KKT criteria, locally
- multi-start algorithms
     - random
	 - Latin hypercube
	 - Sobol sequences
- cumulative distribution of neg log likelihoods [@raue_lessons_2013]
- stochastic global optimization

## constraints (box)

- independent inequality constraints
- built into some optimizers (`optim/L-BFGS-B`, `nloptr` tools)
- transformations 
     - convenient; can also improve Wald approximation, improve scaling
     - bad if parameter is actually *on* the boundary
- e.g. negative binomial parameter: var=$\mu(1+\mu/k)$.  Often use $\log(k)$ to keep it positive, but what if equi/underdispersed?  Use $1/k$ with lower bound at 0?

# troubleshooting

## parameterization

- mathematically pretty: $ax/(1+bx)$
- simpler units: $ax/(1+x/c)$
- traditional: $ax/(1+ahx)$
- separate features: $ax/(1+(a/d)x)$, $d>0$

## references
